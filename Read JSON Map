Imports Newtonsoft.Json
Imports System.IO

Public Class MapObject
    <JsonProperty("header")>
    Public Property Header As HeaderObject

    <JsonProperty("world")>
    Public Property World As WorldObject
End Class

Public Class HeaderObject
    <JsonProperty("creation_build")>
    Public Property Creation_Build As String

    <JsonProperty("creation_date")>
    Public Property Creation_Date As New System.Collections.Specialized.OrderedDictionary

    <JsonProperty("uses_default_assets")>
    Public Property Uses_Default_Assets As Boolean
End Class

Public Class WorldObject
    <JsonProperty("levels")>
    Public Property Levels() As LevelListObject
End Class

Public Class LevelListObject
    <JsonProperty("0")>
    Public Property Level0 As LevelObject

    <JsonProperty("1")>
    Public Property Level1 As LevelObject

    <JsonProperty("2")>
    Public Property Level2 As LevelObject

    <JsonProperty("3")>
    Public Property Level3 As LevelObject

    <JsonProperty("4")>
    Public Property Level4 As LevelObject

    <JsonProperty("5")>
    Public Property Level5 As LevelObject

    <JsonProperty("6")>
    Public Property Level6 As LevelObject

    <JsonProperty("7")>
    Public Property Level7 As LevelObject
End Class

Public Class LevelObject
    <JsonProperty("patterns")>
    Public Property Patterns As List(Of TextureObject)

    <JsonProperty("walls")>
    Public Property Walls As List(Of WallObject)

    <JsonProperty("portals")>
    Public Property Portals As List(Of TextureObject)

    <JsonProperty("terrain")>
    Public Property Terrain As TerrainObject

    <JsonProperty("materials")>
    Public Property MaterialLayers() As MaterialLayerObject

    <JsonProperty("paths")>
    Public Property Paths As List(Of TextureObject)

    <JsonProperty("objects")>
    Public Property Images As List(Of TextureObject)

    <JsonProperty("lights")>
    Public Property Lights As List(Of TextureObject)
End Class
Public Class MaterialLayerObject
    <JsonProperty("-400")>
    Public Property BelowGround As List(Of MaterialObject)

    <JsonProperty("-100")>
    Public Property BelowWater As List(Of MaterialObject)

    <JsonProperty("100")>
    Public Property UserLayer1 As List(Of MaterialObject)

    <JsonProperty("200")>
    Public Property UserLayer2 As List(Of MaterialObject)

    <JsonProperty("300")>
    Public Property UserLayer3 As List(Of MaterialObject)

    <JsonProperty("400")>
    Public Property UserLayer4 As List(Of MaterialObject)

    <JsonProperty("700")>
    Public Property AboveWalls As List(Of MaterialObject)
End Class

Public Class MaterialObject
    <JsonProperty("texture")>
    Public Property Texture As String
End Class

Public Class TerrainObject
    <JsonProperty("texture_1")>
    Public Property Texture1 As String
    <JsonProperty("texture_2")>
    Public Property Texture2 As String
    <JsonProperty("texture_3")>
    Public Property Texture3 As String
    <JsonProperty("texture_4")>
    Public Property Texture4 As String
End Class

Public Class WallObject
    <JsonProperty("texture")>
    Public Property Texture As String
    <JsonProperty("portals")>
    Public Property Portals As List(Of TextureObject)

End Class

Public Class TextureObject
    <JsonProperty("texture")>
    Public Property Texture As String
End Class

Module AssetManifestModule
    Public Sub GetMapJSON()
        Dim MapFile As String = "C:\Users\Jim\Documents\SpaceShip.dungeondraft_map"
        Dim rawJson = File.ReadAllText(MapFile)
        Dim JSONObject = JsonConvert.DeserializeObject(Of MapObject)(rawJson)
    End Sub
End Module
